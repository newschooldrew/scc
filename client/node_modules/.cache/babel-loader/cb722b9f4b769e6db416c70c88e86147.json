{"ast":null,"code":"var _jsxFileName = \"/Users/andrewperez/Documents/projects/scc/client/src/Checkout/CheckoutForm.js\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport AuthContext from '../AuthContext';\nimport { CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport { createPaymentIntent, createOrder } from '../actions';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport { withRouter } from 'react-router-dom';\nimport { Button, Form, FormGroup, Label, Input } from 'reactstrap';\nimport './CheckoutForm.scss';\n\nconst CheckoutForm = ({\n  price,\n  history\n}) => {\n  const {\n    state,\n    dispatch\n  } = useContext(AuthContext);\n  const {\n    orderConfirmation\n  } = state;\n  const [clientSecret, setClientSecret] = useState(null);\n  const [error, setError] = useState(null);\n  const [metadata, setMetadata] = useState(null);\n  const [processing, setProcessing] = useState(false);\n  const [actualName, setActualName] = useState('');\n  const [lastName, setLastName] = useState('');\n  const [address, setAddress] = useState('');\n  const [city, setCity] = useState('');\n  const [province, setProvince] = useState('');\n  const [postal_code, setPostalCode] = useState('');\n  const [email, setEmail] = useState('');\n  const stripe = useStripe();\n  const elements = useElements();\n  const mobileSize = useMediaQuery('(max-width:600px)');\n  let cartTotal = JSON.parse(sessionStorage.getItem('cart'));\n  useEffect(() => {\n    const item = {\n      actualName,\n      address,\n      city,\n      province,\n      postal_code,\n      email,\n      price,\n      cartTotal\n    };\n    createPaymentIntent(item).then(clientSecret => {\n      setClientSecret(clientSecret.client_secret);\n    }).catch(err => {\n      setError(err.message);\n    });\n  }, []);\n  useEffect(() => {\n    const item = {\n      actualName,\n      address,\n      city,\n      province,\n      postal_code,\n      email,\n      price,\n      cartTotal\n    };\n    createPaymentIntent(item).then(clientSecret => {\n      setClientSecret(clientSecret.client_secret);\n    }).catch(err => {\n      setError(err.message);\n    });\n  }, [price]);\n  useEffect(() => {\n    console.log(\"orderConfirmation\");\n    console.log(orderConfirmation);\n    console.log(typeof orderConfirmation);\n\n    if (orderConfirmation && typeof orderConfirmation == 'object' && orderConfirmation.length > 0) {\n      console.log(orderConfirmation[0].title);\n      dispatch({\n        type: \"SET_ALERT\",\n        payload: orderConfirmation[0].title\n      });\n    } else if (typeof orderConfirmation == 'string') {\n      history.push('/receipt');\n    }\n  }, [orderConfirmation]);\n\n  const handleSubmit = async ev => {\n    ev.preventDefault();\n    setProcessing(true);\n    const item = {\n      actualName,\n      lastName,\n      address,\n      city,\n      province,\n      postal_code,\n      email,\n      price,\n      cartTotal\n    };\n    createPaymentIntent(item).then(clientSecret => {\n      setClientSecret(clientSecret.client_secret);\n    }).catch(err => {\n      setError(err.message);\n    }); // Step 3: Use clientSecret from PaymentIntent and the CardElement\n    // to confirm payment with stripe.confirmCardPayment()\n\n    const payload = await stripe.confirmCardPayment(clientSecret, {\n      payment_method: {\n        card: elements.getElement(CardElement),\n        billing_details: {\n          name: ev.target.name.value\n        }\n      }\n    });\n    console.log(\"payload:\");\n    console.log(payload);\n\n    if (payload.error || !payload) {\n      setError(`Payment failed: ${payload.error.message}`);\n      setProcessing(false);\n      console.log(\"[error]\", payload.error);\n    } else {\n      setError(null);\n      setProcessing(false);\n      setMetadata(payload.paymentIntent);\n      console.log(\"[PaymentIntent]\", payload.paymentIntent);\n      dispatch({\n        type: \"CREATE_ORDER\",\n        payload: item\n      });\n      createOrder(item, dispatch);\n    }\n  };\n\n  const renderForm = () => {\n    const options = {\n      style: {\n        base: {\n          color: \"#32325d\",\n          fontFamily: '\"Helvetica Neue\", Helvetica, sans-serif',\n          fontSmoothing: \"antialiased\",\n          fontSize: \"16px\",\n          \"::placeholder\": {\n            color: \"#aab7c4\"\n          }\n        },\n        invalid: {\n          color: \"#fa755a\",\n          iconColor: \"#fa755a\"\n        }\n      }\n    };\n    const formStyles = {\n      margin: '0 0 8% 0',\n      display: 'flex',\n      maxWidth: '100% !important'\n    };\n    const mobFormStyles = {\n      margin: '0',\n      display: 'flex',\n      maxWidth: '100% !important'\n    };\n    const outerStyles = {\n      justifyContent: 'spaceBetween',\n      width: '13%'\n    };\n    const mobOuterStyles = {\n      justifyContent: 'spaceBetween',\n      width: '0%'\n    };\n    const innerStyles = {\n      justifyContent: 'spaceBetween',\n      width: '74%'\n    };\n    const mobInnerStyles = {\n      justifyContent: 'spaceBetween',\n      width: '100%'\n    };\n    return /*#__PURE__*/React.createElement(\"div\", {\n      style: mobileSize ? mobFormStyles : formStyles,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      style: mobileSize ? mobOuterStyles : outerStyles,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Form, {\n      style: mobileSize ? mobInnerStyles : innerStyles,\n      onSubmit: handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(FormGroup, {\n      className: \"col-md-6\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      for: \"name\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 17\n      }\n    }, \"Name\"), /*#__PURE__*/React.createElement(Input, {\n      type: \"text\",\n      id: \"name\",\n      name: \"name\",\n      placeholder: \"Name\",\n      autoComplete: \"cardholder\",\n      className: \"sr-input\",\n      onChange: e => setActualName(e.target.value),\n      value: actualName,\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 29\n      }\n    })), /*#__PURE__*/React.createElement(FormGroup, {\n      className: \"col-md-6\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      for: \"lastName\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 21\n      }\n    }, \"Last Name\"), /*#__PURE__*/React.createElement(Input, {\n      type: \"text\",\n      id: \"lastName\",\n      name: \"lastName\",\n      placeholder: \"Last name\",\n      className: \"sr-input\",\n      onChange: e => setLastName(e.target.value),\n      value: lastName,\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 25\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(FormGroup, {\n      className: \"col-md-6\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      for: \"address\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 19\n      }\n    }, \"Address\"), /*#__PURE__*/React.createElement(Input, {\n      type: \"text\",\n      id: \"address\",\n      name: \"Address\",\n      placeholder: \"Address\",\n      className: \"sr-input\",\n      onChange: e => setAddress(e.target.value),\n      value: address,\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 31\n      }\n    })), /*#__PURE__*/React.createElement(FormGroup, {\n      className: \"col-md-6\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      for: \"address\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 19\n      }\n    }, \"City\"), /*#__PURE__*/React.createElement(Input, {\n      type: \"text\",\n      id: \"city\",\n      name: \"City\",\n      placeholder: \"City\",\n      className: \"sr-input\",\n      onChange: e => setCity(e.target.value),\n      value: city,\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 19\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(FormGroup, {\n      className: \"col-md-6\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      for: \"address\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 19\n      }\n    }, \"State\"), /*#__PURE__*/React.createElement(Input, {\n      type: \"text\",\n      id: \"province\",\n      name: \"province\",\n      placeholder: \"State\",\n      className: \"sr-input\",\n      onChange: e => setProvince(e.target.value),\n      value: province,\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 23\n      }\n    })), /*#__PURE__*/React.createElement(FormGroup, {\n      className: \"col-md-6\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      for: \"address\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 19\n      }\n    }, \"Postal Code\"), /*#__PURE__*/React.createElement(Input, {\n      type: \"text\",\n      id: \"postal_code\",\n      name: \"postal_code\",\n      placeholder: \"Postal Code\",\n      className: \"sr-input\",\n      onChange: e => setPostalCode(e.target.value),\n      value: postal_code,\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 23\n      }\n    })), /*#__PURE__*/React.createElement(FormGroup, {\n      className: \"col-md-12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      for: \"address\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 19\n      }\n    }, \"Email\"), /*#__PURE__*/React.createElement(Input, {\n      type: \"text\",\n      id: \"email\",\n      name: \"email\",\n      placeholder: \"Email\",\n      className: \"sr-input\",\n      onChange: e => setEmail(e.target.value),\n      value: email,\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 23\n      }\n    }))), /*#__PURE__*/React.createElement(CardElement, {\n      className: \"sr-input sr-card-element\",\n      options: options,\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 13\n      }\n    }), error && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"message sr-field-error\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 19\n      }\n    }, error), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 9\n      }\n    }, processing ? \"Processing…\" : \"Pay\")), /*#__PURE__*/React.createElement(\"div\", {\n      style: mobileSize ? mobOuterStyles : outerStyles,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 7\n      }\n    }));\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"checkout-form\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sr-payment-form\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sr-form-row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 9\n    }\n  }), renderForm()));\n};\n\nexport default withRouter(CheckoutForm);","map":{"version":3,"sources":["/Users/andrewperez/Documents/projects/scc/client/src/Checkout/CheckoutForm.js"],"names":["React","useContext","useEffect","useState","AuthContext","CardElement","useStripe","useElements","createPaymentIntent","createOrder","useMediaQuery","withRouter","Button","Form","FormGroup","Label","Input","CheckoutForm","price","history","state","dispatch","orderConfirmation","clientSecret","setClientSecret","error","setError","metadata","setMetadata","processing","setProcessing","actualName","setActualName","lastName","setLastName","address","setAddress","city","setCity","province","setProvince","postal_code","setPostalCode","email","setEmail","stripe","elements","mobileSize","cartTotal","JSON","parse","sessionStorage","getItem","item","then","client_secret","catch","err","message","console","log","length","title","type","payload","push","handleSubmit","ev","preventDefault","confirmCardPayment","payment_method","card","getElement","billing_details","name","target","value","paymentIntent","renderForm","options","style","base","color","fontFamily","fontSmoothing","fontSize","invalid","iconColor","formStyles","margin","display","maxWidth","mobFormStyles","outerStyles","justifyContent","width","mobOuterStyles","innerStyles","mobInnerStyles","e"],"mappings":"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","sourcesContent":["import React, {useContext, useEffect, useState } from \"react\";\nimport AuthContext from '../AuthContext'\nimport { CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport {createPaymentIntent,createOrder} from '../actions'\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport {withRouter} from 'react-router-dom'\nimport { Button,Form, FormGroup, Label, Input } from 'reactstrap';\nimport './CheckoutForm.scss'\n\nconst CheckoutForm = ({price,history}) => {\n  const {state,dispatch} = useContext(AuthContext)\n  const {orderConfirmation} = state;\n\n  const [clientSecret, setClientSecret] = useState(null);\n  const [error, setError] = useState(null);\n  const [metadata, setMetadata] = useState(null);\n  const [processing, setProcessing] = useState(false);\n  const [actualName,setActualName] = useState('')\n  const [lastName,setLastName] = useState('')\n  const [address,setAddress] = useState('')\n  const [city,setCity] = useState('')\n  const [province,setProvince] = useState('')\n  const [postal_code,setPostalCode] = useState('')\n  const [email,setEmail] = useState('')\n  const stripe = useStripe();\n  const elements = useElements();\n  const mobileSize = useMediaQuery('(max-width:600px)');\n\n  let cartTotal = JSON.parse(sessionStorage.getItem('cart'))\n\n  useEffect(() => {\n    const item = {actualName,address,city,province,postal_code,email,price,cartTotal}\n      createPaymentIntent(item)\n      .then((clientSecret) => {\n          setClientSecret(clientSecret.client_secret)\n      })\n      .catch((err) => {\n        setError(err.message);\n      });\n  },[]);\n\n  useEffect(() => {\n    const item = {actualName,address,city,province,postal_code,email,price,cartTotal}\n      createPaymentIntent(item)\n      .then((clientSecret) => {\n          setClientSecret(clientSecret.client_secret)\n      })\n      .catch((err) => {\n        setError(err.message);\n      });\n  },[price]);\n\n  useEffect(() => {\n    console.log(\"orderConfirmation\")\n    console.log(orderConfirmation)\n    console.log(typeof orderConfirmation)\n    if(orderConfirmation && typeof orderConfirmation == 'object' && orderConfirmation.length > 0){\n      console.log(orderConfirmation[0].title)\n      dispatch({type:\"SET_ALERT\",payload:orderConfirmation[0].title})\n    } else if(typeof orderConfirmation == 'string'){\n      history.push('/receipt')\n    }\n  },[orderConfirmation]);\n  \n  const handleSubmit = async (ev) => {\n    ev.preventDefault();\n    setProcessing(true);\n    const item = {actualName,lastName,address,city,province,postal_code,email,price,cartTotal}\n    \n    createPaymentIntent(item)\n    .then((clientSecret) => {\n        setClientSecret(clientSecret.client_secret)\n    })\n    .catch((err) => {\n      setError(err.message);\n    });\n\n    // Step 3: Use clientSecret from PaymentIntent and the CardElement\n    // to confirm payment with stripe.confirmCardPayment()\n    const payload = await stripe.confirmCardPayment(clientSecret, {\n      payment_method: {\n        card: elements.getElement(CardElement),\n        billing_details: {\n          name: ev.target.name.value,\n        },\n      },\n    });\n\n    console.log(\"payload:\")\n    console.log(payload)\n\n    if (payload.error || !payload) {\n      setError(`Payment failed: ${payload.error.message}`);\n      setProcessing(false);\n      console.log(\"[error]\", payload.error);\n    } else {\n      setError(null);\n      setProcessing(false);\n      setMetadata(payload.paymentIntent);\n      console.log(\"[PaymentIntent]\", payload.paymentIntent)\n      dispatch({type:\"CREATE_ORDER\",payload:item})\n      createOrder(item,dispatch)\n    }\n  };\n\n  const renderForm = () => {\n    const options = {\n      style: {\n        base: {\n          color: \"#32325d\",\n          fontFamily: '\"Helvetica Neue\", Helvetica, sans-serif',\n          fontSmoothing: \"antialiased\",\n          fontSize: \"16px\",\n          \"::placeholder\": {\n            color: \"#aab7c4\",\n          },\n        },\n        invalid: {\n          color: \"#fa755a\",\n          iconColor: \"#fa755a\",\n        },\n      },\n    };\n\n    const formStyles = {\n      margin: '0 0 8% 0',\n      display:'flex',\n      maxWidth:'100% !important'\n    }\n\n    const mobFormStyles = {\n      margin: '0',\n      display:'flex',\n      maxWidth:'100% !important'\n    }\n\n    const outerStyles = {\n      justifyContent:'spaceBetween',\n      width:'13%'\n    }\n\n    const mobOuterStyles = {\n      justifyContent:'spaceBetween',\n      width:'0%'\n    }\n\n    const innerStyles = {\n      justifyContent:'spaceBetween',\n      width:'74%'\n    }\n\n    const mobInnerStyles = {\n      justifyContent:'spaceBetween',\n      width:'100%'\n    }\n\n    return (\n        <div style={mobileSize ? mobFormStyles : formStyles}>\n        <div style={mobileSize ? mobOuterStyles : outerStyles}></div>\n      <Form style={mobileSize ? mobInnerStyles :innerStyles} onSubmit={handleSubmit}>\n\n      <div className=\"form-row\">\n                <FormGroup className=\"col-md-6\">\n                <Label for=\"name\">Name</Label>\n                            <Input\n                            type=\"text\"\n                            id=\"name\"\n                            name=\"name\"\n                            placeholder=\"Name\"\n                            autoComplete=\"cardholder\"\n                            className=\"sr-input\"\n                            onChange={e => setActualName(e.target.value)}\n                            value={actualName}\n                            required\n                            />\n                </FormGroup>\n                \n                    <FormGroup className=\"col-md-6\">\n                    <Label for=\"lastName\">Last Name</Label>\n                        <Input\n                        type=\"text\"\n                        id=\"lastName\"\n                        name=\"lastName\"\n                        placeholder=\"Last name\"\n                        className=\"sr-input\"\n                        onChange={e => setLastName(e.target.value)}\n                        value={lastName}\n                        required\n                        />\n                    </FormGroup>\n              </div>\n          <div className=\"form-row\">\n                  <FormGroup className=\"col-md-6\">\n                  <Label for=\"address\">Address</Label>\n                              <Input\n                              type=\"text\"\n                              id=\"address\"\n                              name=\"Address\"\n                              placeholder=\"Address\"\n                              className=\"sr-input\"\n                              onChange={e => setAddress(e.target.value)}\n                              value={address}\n                              required\n                              />\n                  </FormGroup>\n\n                  <FormGroup className=\"col-md-6\">\n                  <Label for=\"address\">City</Label>\n                  <Input\n                    type=\"text\"\n                    id=\"city\"\n                    name=\"City\"\n                    placeholder=\"City\"\n                    className=\"sr-input\"\n                    onChange={e => setCity(e.target.value)}\n                    value={city}\n                    required\n                    />\n                  </FormGroup>\n            </div>\n            <div className=\"form-row\">\n                  <FormGroup className=\"col-md-6\">\n                  <Label for=\"address\">State</Label>\n                      <Input\n                      type=\"text\"\n                      id=\"province\"\n                      name=\"province\"\n                      placeholder=\"State\"\n                      className=\"sr-input\"\n                      onChange={e => setProvince(e.target.value)}\n                      value={province}\n                      required\n                      />\n                  </FormGroup>\n                \n                  <FormGroup className=\"col-md-6\">\n                  <Label for=\"address\">Postal Code</Label>\n                      <Input\n                      type=\"text\"\n                      id=\"postal_code\"\n                      name=\"postal_code\"\n                      placeholder=\"Postal Code\"\n                      className=\"sr-input\"\n                      onChange={e => setPostalCode(e.target.value)}\n                      value={postal_code}\n                      required\n                      />\n                  </FormGroup>\n                \n                  <FormGroup className=\"col-md-12\">\n                  <Label for=\"address\">Email</Label>\n                      <Input\n                      type=\"text\"\n                      id=\"email\"\n                      name=\"email\"\n                      placeholder=\"Email\"\n                      className=\"sr-input\"\n                      onChange={e => setEmail(e.target.value)}\n                      value={email}\n                      required\n                      />\n                  </FormGroup>\n          </div>\n\n            <CardElement\n              className=\"sr-input sr-card-element\"\n              options={options}\n              required\n              />\n\n        {error && <div className=\"message sr-field-error\">{error}</div>}\n\n        <button\n        className=\"btn\"\n          >\n            {processing ? \"Processing…\" : \"Pay\"}\n        </button>\n          \n      </Form>\n      <div style={mobileSize ? mobOuterStyles : outerStyles}></div>\n      </div>\n    );\n  };\n\n  return (\n    <div className=\"checkout-form\">\n      <div className=\"sr-payment-form\">\n        <div className=\"sr-form-row\" />\n        {renderForm()}\n      </div>\n    </div>\n  );\n}\n\nexport default withRouter(CheckoutForm)"]},"metadata":{},"sourceType":"module"}