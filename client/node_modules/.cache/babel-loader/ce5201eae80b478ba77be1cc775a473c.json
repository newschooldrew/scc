{"ast":null,"code":"var _jsxFileName = \"/Users/andrewperez/Documents/projects/scc/client/src/Checkout/CheckoutForm.js\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport AuthContext from '../AuthContext';\nimport { CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport { createPaymentIntent, createOrder, getProductDetails } from '../actions';\nimport { withRouter } from 'react-router-dom';\nimport { Col, Row, Button, Form, FormGroup, Label, Input } from 'reactstrap';\n\nconst CheckoutForm = ({\n  price,\n  history\n}) => {\n  const {\n    state,\n    dispatch\n  } = useContext(AuthContext);\n  const {\n    username,\n    cartItems\n  } = state;\n  const [clientSecret, setClientSecret] = useState(null);\n  const [error, setError] = useState(null);\n  const [metadata, setMetadata] = useState(null);\n  const [succeeded, setSucceeded] = useState(false);\n  const [processing, setProcessing] = useState(false);\n  const [actualName, setActualName] = useState('');\n  const [address, setAddress] = useState('');\n  const [city, setCity] = useState('');\n  const [province, setProvince] = useState('');\n  const [postal_code, setPostalCode] = useState('');\n  const stripe = useStripe();\n  const elements = useElements();\n  let cartTotal = JSON.parse(sessionStorage.getItem('cart'));\n  useEffect(() => {\n    const item = {\n      actualName,\n      address,\n      city,\n      province,\n      postal_code,\n      price,\n      cartTotal\n    };\n    createPaymentIntent(item).then(clientSecret => {\n      console.log(\"clientSecret:\");\n      console.log(clientSecret.client_secret);\n      setClientSecret(clientSecret.client_secret);\n      console.log(\"clientSecret:\");\n      console.log(clientSecret);\n    }).catch(err => {\n      setError(err.message);\n    });\n  }, []);\n\n  const handleSubmit = async ev => {\n    console.log(clientSecret);\n    ev.preventDefault();\n    setProcessing(true);\n    const item = {\n      actualName,\n      address,\n      city,\n      province,\n      postal_code,\n      price,\n      cartTotal\n    };\n    createPaymentIntent(item).then(clientSecret => {\n      console.log(\"clientSecret:\");\n      console.log(clientSecret.client_secret);\n      setClientSecret(clientSecret.client_secret);\n      console.log(\"clientSecret:\");\n      console.log(clientSecret);\n    }).catch(err => {\n      setError(err.message);\n    }); // Step 3: Use clientSecret from PaymentIntent and the CardElement\n    // to confirm payment with stripe.confirmCardPayment()\n\n    const payload = await stripe.confirmCardPayment(clientSecret, {\n      payment_method: {\n        card: elements.getElement(CardElement),\n        billing_details: {\n          name: ev.target.name.value\n        }\n      }\n    });\n    console.log(\"payload:\");\n    console.log(payload);\n\n    if (payload.error) {\n      setError(`Payment failed: ${payload.error.message}`);\n      setProcessing(false);\n      console.log(\"[error]\", payload.error);\n    } else {\n      setError(null);\n      setProcessing(false);\n      setMetadata(payload.paymentIntent);\n      console.log(\"[PaymentIntent]\", payload.paymentIntent);\n    }\n\n    createOrder(item);\n    history.push('/receipt');\n  };\n\n  const renderSuccess = () => {\n    const item = {\n      actualName,\n      address,\n      city,\n      province,\n      postal_code,\n      price,\n      cartTotal\n    };\n  };\n\n  const renderForm = () => {\n    console.log(\"stripe\");\n    console.log(stripe);\n    console.log(\"clientSecret\");\n    console.log(clientSecret);\n    const options = {\n      style: {\n        base: {\n          color: \"#32325d\",\n          fontFamily: '\"Helvetica Neue\", Helvetica, sans-serif',\n          fontSmoothing: \"antialiased\",\n          fontSize: \"16px\",\n          \"::placeholder\": {\n            color: \"#aab7c4\"\n          }\n        },\n        invalid: {\n          color: \"#fa755a\",\n          iconColor: \"#fa755a\"\n        }\n      }\n    };\n    return /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sr-combo-inputs\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sr-combo-inputs-row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(FormGroup, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      md: 3,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(FormGroup, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      for: \"name\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 17\n      }\n    }, \"Name\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      id: \"name\",\n      name: \"name\",\n      placeholder: \"Name\",\n      autoComplete: \"cardholder\",\n      className: \"sr-input\",\n      onChange: e => setActualName(e.target.value),\n      value: actualName,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 29\n      }\n    }))), /*#__PURE__*/React.createElement(Col, {\n      md: 3,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(FormGroup, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      for: \"address\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 21\n      }\n    }, \"Last Name\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      id: \"lastName\",\n      name: \"lastName\",\n      placeholder: \"Last name\",\n      className: \"sr-input\" // onChange={e => setAddress(e.target.value)}\n      ,\n      value: address,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 25\n      }\n    })))), /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      md: 3,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(FormGroup, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      for: \"address\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 13\n      }\n    }, \"Address\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      id: \"address\",\n      name: \"Address\",\n      placeholder: \"Address\",\n      className: \"sr-input\",\n      onChange: e => setAddress(e.target.value),\n      value: address,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 25\n      }\n    }))), /*#__PURE__*/React.createElement(Col, {\n      md: 3,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(FormGroup, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      for: \"address\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 13\n      }\n    }, \"City\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      id: \"city\",\n      name: \"City\",\n      placeholder: \"City\",\n      className: \"sr-input\",\n      onChange: e => setCity(e.target.value),\n      value: city,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 13\n      }\n    })))), /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      md: 3,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(FormGroup, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      for: \"address\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 11\n      }\n    }, \"State\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      id: \"province\",\n      name: \"province\",\n      placeholder: \"State\",\n      className: \"sr-input\",\n      onChange: e => setProvince(e.target.value),\n      value: province,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 15\n      }\n    }))), /*#__PURE__*/React.createElement(Col, {\n      md: 3,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(FormGroup, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      for: \"address\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 11\n      }\n    }, \"Postal Code\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      id: \"postal_code\",\n      name: \"postal_code\",\n      placeholder: \"Postal Code\",\n      className: \"sr-input\",\n      onChange: e => setPostalCode(e.target.value),\n      value: postal_code,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 15\n      }\n    })))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sr-combo-inputs-row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(CardElement, {\n      className: \"sr-input sr-card-element\",\n      options: options,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 13\n      }\n    })))), error && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"message sr-field-error\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 19\n      }\n    }, error), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 9\n      }\n    }, processing ? \"Processing…\" : \"Pay\")));\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"checkout-form\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sr-payment-form\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sr-form-row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 9\n    }\n  }), renderForm()));\n};\n\nexport default withRouter(CheckoutForm);","map":{"version":3,"sources":["/Users/andrewperez/Documents/projects/scc/client/src/Checkout/CheckoutForm.js"],"names":["React","useContext","useEffect","useState","AuthContext","CardElement","useStripe","useElements","createPaymentIntent","createOrder","getProductDetails","withRouter","Col","Row","Button","Form","FormGroup","Label","Input","CheckoutForm","price","history","state","dispatch","username","cartItems","clientSecret","setClientSecret","error","setError","metadata","setMetadata","succeeded","setSucceeded","processing","setProcessing","actualName","setActualName","address","setAddress","city","setCity","province","setProvince","postal_code","setPostalCode","stripe","elements","cartTotal","JSON","parse","sessionStorage","getItem","item","then","console","log","client_secret","catch","err","message","handleSubmit","ev","preventDefault","payload","confirmCardPayment","payment_method","card","getElement","billing_details","name","target","value","paymentIntent","push","renderSuccess","renderForm","options","style","base","color","fontFamily","fontSmoothing","fontSize","invalid","iconColor","e"],"mappings":"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","sourcesContent":["import React, {useContext, useEffect, useState } from \"react\";\nimport AuthContext from '../AuthContext'\nimport { CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport {createPaymentIntent,createOrder,getProductDetails} from '../actions'\nimport {withRouter} from 'react-router-dom'\nimport { Col, Row, Button, Form, FormGroup, Label, Input } from 'reactstrap';\n\nconst CheckoutForm = ({price,history}) => {\n  const {state,dispatch} = useContext(AuthContext)\n  const {username,cartItems} = state;\n  const [clientSecret, setClientSecret] = useState(null);\n  const [error, setError] = useState(null);\n  const [metadata, setMetadata] = useState(null);\n  const [succeeded, setSucceeded] = useState(false);\n  const [processing, setProcessing] = useState(false);\n  const [actualName,setActualName] = useState('')\n  const [address,setAddress] = useState('')\n  const [city,setCity] = useState('')\n  const [province,setProvince] = useState('')\n  const [postal_code,setPostalCode] = useState('')\n  const stripe = useStripe();\n  const elements = useElements();\n\n  let cartTotal = JSON.parse(sessionStorage.getItem('cart'))\n\n  useEffect(() => {\n    const item = {actualName,address,city,province,postal_code,price,cartTotal}\n      createPaymentIntent(item)\n      .then((clientSecret) => {\n          console.log(\"clientSecret:\")\n          console.log(clientSecret.client_secret)\n          setClientSecret(clientSecret.client_secret)\n        console.log(\"clientSecret:\")\n        console.log(clientSecret)\n      })\n      .catch((err) => {\n        setError(err.message);\n      });\n  }, []);\n  \n  const handleSubmit = async (ev) => {\n      console.log(clientSecret)\n    ev.preventDefault();\n    setProcessing(true);\n\n    const item = {actualName,address,city,province,postal_code,price,cartTotal}\n\n    createPaymentIntent(item)\n    .then((clientSecret) => {\n        console.log(\"clientSecret:\")\n        console.log(clientSecret.client_secret)\n        setClientSecret(clientSecret.client_secret)\n      console.log(\"clientSecret:\")\n      console.log(clientSecret)\n    })\n    .catch((err) => {\n      setError(err.message);\n    });\n\n    // Step 3: Use clientSecret from PaymentIntent and the CardElement\n    // to confirm payment with stripe.confirmCardPayment()\n    const payload = await stripe.confirmCardPayment(clientSecret, {\n      payment_method: {\n        card: elements.getElement(CardElement),\n        billing_details: {\n          name: ev.target.name.value,\n        },\n      },\n    });\n\n    console.log(\"payload:\")\n    console.log(payload)\n\n    if (payload.error) {\n      setError(`Payment failed: ${payload.error.message}`);\n      setProcessing(false);\n      console.log(\"[error]\", payload.error);\n    } else {\n      setError(null);\n      setProcessing(false);\n      setMetadata(payload.paymentIntent);\n      console.log(\"[PaymentIntent]\", payload.paymentIntent)\n    }\n    createOrder(item)\n    history.push('/receipt')\n  };\n\n  const renderSuccess = () => {\n    const item = {actualName,address,city,province,postal_code,price,cartTotal}\n  };\n\n  const renderForm = () => {\n      console.log(\"stripe\")\n      console.log(stripe)\n      console.log(\"clientSecret\")\n      console.log(clientSecret)\n    const options = {\n      style: {\n        base: {\n          color: \"#32325d\",\n          fontFamily: '\"Helvetica Neue\", Helvetica, sans-serif',\n          fontSmoothing: \"antialiased\",\n          fontSize: \"16px\",\n          \"::placeholder\": {\n            color: \"#aab7c4\",\n          },\n        },\n        invalid: {\n          color: \"#fa755a\",\n          iconColor: \"#fa755a\",\n        },\n      },\n    };\n\n    return (\n      <form onSubmit={handleSubmit}>\n        <div className=\"sr-combo-inputs\">\n          <div className=\"sr-combo-inputs-row\">\n          <FormGroup>\n          <Row >\n            <Col md={3}>\n                <FormGroup>\n                <Label for=\"name\">Name</Label>\n                            <input\n                            type=\"text\"\n                            id=\"name\"\n                            name=\"name\"\n                            placeholder=\"Name\"\n                            autoComplete=\"cardholder\"\n                            className=\"sr-input\"\n                            onChange={e => setActualName(e.target.value)}\n                            value={actualName}\n                            />\n                </FormGroup>\n                </Col>\n\n                <Col md={3}>\n                    <FormGroup>\n                    <Label for=\"address\">Last Name</Label>\n                        <input\n                        type=\"text\"\n                        id=\"lastName\"\n                        name=\"lastName\"\n                        placeholder=\"Last name\"\n                        className=\"sr-input\"\n                        // onChange={e => setAddress(e.target.value)}\n                        value={address}\n                        />\n                    </FormGroup>\n                </Col>\n            </Row>\n            \n            <Row>\n            <Col md={3}>\n            <FormGroup>\n            <Label for=\"address\">Address</Label>\n                        <input\n                        type=\"text\"\n                        id=\"address\"\n                        name=\"Address\"\n                        placeholder=\"Address\"\n                        className=\"sr-input\"\n                        onChange={e => setAddress(e.target.value)}\n                        value={address}\n                        />\n            </FormGroup>\n            </Col>\n            <Col md={3}>\n            <FormGroup>\n            <Label for=\"address\">City</Label>\n            <input\n              type=\"text\"\n              id=\"city\"\n              name=\"City\"\n              placeholder=\"City\"\n              className=\"sr-input\"\n              onChange={e => setCity(e.target.value)}\n              value={city}\n              />\n            </FormGroup>\n            </Col>\n        </Row>\n        <Row>\n        <Col md={3}>\n          <FormGroup>\n          <Label for=\"address\">State</Label>\n              <input\n              type=\"text\"\n              id=\"province\"\n              name=\"province\"\n              placeholder=\"State\"\n              className=\"sr-input\"\n              onChange={e => setProvince(e.target.value)}\n              value={province}\n              />\n          </FormGroup>\n        </Col>\n\n        <Col md={3}>\n          <FormGroup>\n          <Label for=\"address\">Postal Code</Label>\n              <input\n              type=\"text\"\n              id=\"postal_code\"\n              name=\"postal_code\"\n              placeholder=\"Postal Code\"\n              className=\"sr-input\"\n              onChange={e => setPostalCode(e.target.value)}\n              value={postal_code}\n              />\n          </FormGroup>\n        </Col>\n    </Row>\n          <div className=\"sr-combo-inputs-row\">\n            <CardElement\n              className=\"sr-input sr-card-element\"\n              options={options}\n              />\n              </div>\n              </FormGroup>\n              </div>\n\n        {error && <div className=\"message sr-field-error\">{error}</div>}\n\n        <button\n          className=\"btn\"\n          >\n            {processing ? \"Processing…\" : \"Pay\"}\n        </button>\n          </div>\n      </form>\n    );\n  };\n\n  return (\n    <div className=\"checkout-form\">\n      <div className=\"sr-payment-form\">\n        <div className=\"sr-form-row\" />\n        {renderForm()}\n      </div>\n    </div>\n  );\n}\n\nexport default withRouter(CheckoutForm)"]},"metadata":{},"sourceType":"module"}